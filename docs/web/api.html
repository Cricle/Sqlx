<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sqlx API 文档 | 完整参考手册</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .api-section {
            margin: 3rem 0;
            padding: 2rem;
            background: var(--bg-white);
            border: 1px solid var(--border-color);
            border-radius: 12px;
        }

        .api-item {
            margin: 2rem 0;
            padding: 1.5rem;
            border-left: 4px solid var(--primary-color);
            background: var(--bg-light);
        }

        .api-signature {
            font-family: 'Consolas', monospace;
            background: var(--code-bg);
            color: var(--code-text);
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .param-table th,
        .param-table td {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            text-align: left;
        }

        .param-table th {
            background: var(--bg-light);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container" style="padding: 2rem;">
        <h1>📚 Sqlx API 完整参考</h1>
        
        <!-- 特性 API -->
        <div class="api-section">
            <h2>🏷️ 特性 (Attributes)</h2>
            
            <div class="api-item">
                <h3>[Sqlx]</h3>
                <p>标记方法使用 SQL 模板</p>
                <div class="api-signature">
[Sqlx("SELECT {{columns}} FROM {{table}} WHERE id = @id")]
Task&lt;User&gt; GetByIdAsync(int id);
                </div>
                <table class="param-table">
                    <tr>
                        <th>参数</th>
                        <th>类型</th>
                        <th>说明</th>
                    </tr>
                    <tr>
                        <td>sql</td>
                        <td>string</td>
                        <td>SQL模板字符串，支持占位符</td>
                    </tr>
                </table>
            </div>

            <div class="api-item">
                <h3>[RepositoryFor]</h3>
                <p>指定要实现的接口类型</p>
                <div class="api-signature">
[RepositoryFor(typeof(IUserRepository))]
public partial class UserRepository : IUserRepository
                </div>
            </div>

            <div class="api-item">
                <h3>[SqlDefine]</h3>
                <p>定义数据库方言和表名</p>
                <div class="api-signature">
[SqlDefine(Dialect = SqlDialect.Sqlite, TableName = "users")]
public partial class UserRepository
                </div>
                <table class="param-table">
                    <tr>
                        <th>属性</th>
                        <th>类型</th>
                        <th>说明</th>
                    </tr>
                    <tr>
                        <td>Dialect</td>
                        <td>SqlDialect</td>
                        <td>数据库类型：Sqlite, SqlServer, MySql, PostgreSql, Oracle, DB2</td>
                    </tr>
                    <tr>
                        <td>TableName</td>
                        <td>string</td>
                        <td>表名（可选，默认从类名推断）</td>
                    </tr>
                </table>
            </div>

            <div class="api-item">
                <h3>[TableName]</h3>
                <p>为实体类指定表名</p>
                <div class="api-signature">
[TableName("custom_users")]
public class User
{
    public int Id { get; set; }
    public string Name { get; set; }
}
                </div>
            </div>
        </div>

        <!-- 占位符 API -->
        <div class="api-section">
            <h2>📝 占位符系统</h2>
            
            <table class="param-table">
                <tr>
                    <th>占位符</th>
                    <th>说明</th>
                    <th>示例输出</th>
                </tr>
                <tr>
                    <td><code>{{table}}</code></td>
                    <td>表名</td>
                    <td><code>users</code></td>
                </tr>
                <tr>
                    <td><code>{{columns}}</code></td>
                    <td>所有列名</td>
                    <td><code>id, name, email</code></td>
                </tr>
                <tr>
                    <td><code>{{columns --exclude Id}}</code></td>
                    <td>排除指定列</td>
                    <td><code>name, email</code></td>
                </tr>
                <tr>
                    <td><code>{{values}}</code></td>
                    <td>参数占位符</td>
                    <td><code>@Name, @Email</code></td>
                </tr>
                <tr>
                    <td><code>{{set}}</code></td>
                    <td>UPDATE SET子句</td>
                    <td><code>name=@Name, email=@Email</code></td>
                </tr>
                <tr>
                    <td><code>{{orderby col --desc}}</code></td>
                    <td>排序</td>
                    <td><code>ORDER BY col DESC</code></td>
                </tr>
            </table>
        </div>

        <!-- Partial 方法 -->
        <div class="api-section">
            <h2>🔧 Partial 方法</h2>
            
            <div class="api-item">
                <h3>OnExecuting</h3>
                <p>SQL执行前拦截</p>
                <div class="api-signature">
partial void OnExecuting(string operation, IDbCommand command);
                </div>
                <table class="param-table">
                    <tr>
                        <th>参数</th>
                        <th>说明</th>
                    </tr>
                    <tr>
                        <td>operation</td>
                        <td>操作名称（方法名）</td>
                    </tr>
                    <tr>
                        <td>command</td>
                        <td>DbCommand对象，可修改SQL和参数</td>
                    </tr>
                </table>
            </div>

            <div class="api-item">
                <h3>OnExecuted</h3>
                <p>SQL执行成功后拦截</p>
                <div class="api-signature">
partial void OnExecuted(string operation, IDbCommand command, 
                        object? result, long elapsedTicks);
                </div>
            </div>

            <div class="api-item">
                <h3>OnExecuteFail</h3>
                <p>SQL执行失败时拦截</p>
                <div class="api-signature">
partial void OnExecuteFail(string operation, IDbCommand command, 
                           Exception ex, long elapsedTicks);
                </div>
            </div>
        </div>

        <p style="text-align: center; margin-top: 3rem;">
            <a href="index.html" style="color: var(--primary-color); text-decoration: none;">← 返回首页</a>
        </p>
    </div>
</body>
</html>

